<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>backend_python.src.rag.indexer API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>backend_python.src.rag.indexer</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="backend_python.src.rag.indexer.demo_rag_pipeline"><code class="name flex">
<span>def <span class="ident">demo_rag_pipeline</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Exécute une démonstration de pipeline de recherche assisté par un récupérateur d'information
(RAG - Retrieval-Augmented Generation). Ce programme commence par charger le
répertoire du projet via une variable d'environnement, puis utilise le module RAG
pour afficher des statistiques et démontrer des recherches sur des tableaux de données.</p>
<p>:param dir_dossier: Le répertoire principal du projet défini par la variable d'environnement
"PROJECT_DIR".
:type dir_dossier: str</p>
<p>:param queries: Liste des requêtes de recherche utilisées pour explorer la base de données.
:type queries: List[str]</p>
<p>:return: Cette fonction ne retourne aucune valeur, elle affiche directement les résultats
des tests de recherche dans la console.</p></div>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="backend_python.src.rag.indexer.RAGTableIndex"><code class="flex name class">
<span>class <span class="ident">RAGTableIndex</span></span>
<span>(</span><span>db_path: str = './chroma_db',<br>model_name: str = 'sentence-transformers/all-MiniLM-L6-v2')</span>
</code></dt>
<dd>
<div class="desc"><p>Classe permettant de gérer un index RAG pour les tableaux.</p>
<p>Cette classe assure la gestion des opérations d'indexation, la génération
d'embeddings pour la recherche, ainsi que la manipulation des métadonnées
des tableaux pour des analyses et recherches avancées. Elle repose sur un
modèle d'embeddings basé sur <code>sentence-transformers</code> et un stockage dans
une base de données persistante gérée par ChromaDB.</p>
<p>:ivar db_path: Chemin vers la base de données persistante ChromaDB.
:type db_path: str
:ivar model_name: Nom du modèle pré-entraîné sentence-transformers utilisé.
:type model_name: str
:ivar embedding_model: Instance du modèle d'embeddings chargé.
:type embedding_model: SentenceTransformer
:ivar client: Instance du client ChromaDB configuré.
:type client: chromadb.PersistentClient
:ivar collection: Collection spécifique pour stocker les tableaux indexés.
:type collection: chromadb.Collection</p>
<p>Initialise une instance pour gérer les embeddings et la base de données persistante avec ChromaDB.</p>
<p>L'initialisation implique le chargement d'un modèle de calcul d'embeddings à utiliser
pour le traitement des données, ainsi que la connexion ou la création d'une collection
de la base de données persistante.</p>
<p>:param db_path: Chemin vers la base de données persistante Chroma (par défaut "./chroma_db")
:type db_path: str
:param model_name: Nom ou chemin du modèle d'embeddings à charger (par défaut
"sentence-transformers/all-MiniLM-L6-v2")
:type model_name: str</p></div>
<h3>Methods</h3>
<dl>
<dt id="backend_python.src.rag.indexer.RAGTableIndex.afficher_resultats"><code class="name flex">
<span>def <span class="ident">afficher_resultats</span></span>(<span>self, results: Dict[str, Any])</span>
</code></dt>
<dd>
<div class="desc"><p>Affiche les résultats d'une recherche sous forme lisible.</p>
<p>Cette méthode affiche une représentation textuelle des résultats
fournis pour une requête donnée. Elle affiche des informations
détaillées sur chaque tableau trouvé, y compris son titre, sa
source, le nombre de lignes, le niveau d'accès, les colonnes et
le chemin d'accès.</p>
<p>:param results: Contient les informations sur les résultats de la requête.
- query (str): Le terme de la requête.
- nb_resultats (int): Nombre total de tableaux trouvés.
- tableaux (List[Dict]): Liste des informations relatives
aux tableaux trouvés. Chaque tableau contient :
- titre (str): Titre du tableau.
- source (str): Source du tableau.
- feuille (str): Nom de la feuille correspondante.
- nb_lignes (int): Nombre de lignes contenues.
- access_level (Optional[str]): Niveau d'accès (public
par défaut si absent).
- colonnes (List[str]): Liste des noms des colonnes
(limitées à 5 colonnes en affichage).
- tableau_path (str): Chemin vers le fichier du tableau.</p>
<p>:return: Cette méthode ne retourne aucune valeur.</p></div>
</dd>
<dt id="backend_python.src.rag.indexer.RAGTableIndex.extraire_colonnes_de_description"><code class="name flex">
<span>def <span class="ident">extraire_colonnes_de_description</span></span>(<span>self, description: str) ‑> List[str]</span>
</code></dt>
<dd>
<div class="desc"><p>Analyse et extrait les colonnes listées dans une description textuelle.</p>
<p>Cette méthode analyse un texte de type description, identifie une éventuelle ligne
contenant des colonnes sous le format "COLONNES:", et retourne une liste des
colonnes spécifiées, après suppression des espaces superflus.</p>
<p>:param description: La description textuelle contenant potentiellement une
liste de colonnes à extraire, sous le format "COLONNES: colonne1, colonne2, &hellip;".
:type description: str
:return: Une liste de chaînes de caractères correspondant aux noms des colonnes
extraites. Si aucune ligne contenant "COLONNES:" n'est trouvée, la méthode
retourne une liste vide.
:rtype: List[str]</p></div>
</dd>
<dt id="backend_python.src.rag.indexer.RAGTableIndex.generer_embeddings"><code class="name flex">
<span>def <span class="ident">generer_embeddings</span></span>(<span>self, descriptions: List[str]) ‑> List[List[float]]</span>
</code></dt>
<dd>
<div class="desc"><p>Génère des représentations numériques (embeddings) pour une liste de descriptions.
Ces embeddings sont issus du modèle d'encodage défini dans l'objet et permettent
de représenter le contenu textuel dans un espace vectoriel.</p>
<p>:param descriptions: Une liste de chaînes de caractères pour lesquelles les embeddings
doivent être générés.
:type descriptions: List[str]
:return: Une liste de listes de flottants représentant les embeddings générés pour
chaque description donnée.
:rtype: List[List[float]]</p></div>
</dd>
<dt id="backend_python.src.rag.indexer.RAGTableIndex.get_tableau_data"><code class="name flex">
<span>def <span class="ident">get_tableau_data</span></span>(<span>self, tableau_path: str) ‑> Dict</span>
</code></dt>
<dd>
<div class="desc"><p>Lit et charge les données d'un fichier JSON à partir du chemin spécifié.</p>
<p>Cette fonction permet de lire un fichier JSON depuis un chemin donné et renvoie
les données contenues dans ce fichier sous forme de dictionnaire. En cas d'erreur
lors de l'ouverture ou du traitement du fichier, elle affiche un message
d'erreur et renvoie un dictionnaire vide.</p>
<p>:param tableau_path: Chemin d'accès complet au fichier JSON à charger.
:type tableau_path: str
:return: Dictionnaire contenant les données extraites du fichier JSON.
Retourne un dictionnaire vide en cas d'échec.
:rtype: Dict
:raises FileNotFoundError: Si le fichier spécifié est introuvable.
:raises JSONDecodeError: Si le fichier n'est pas un fichier JSON valide.</p></div>
</dd>
<dt id="backend_python.src.rag.indexer.RAGTableIndex.indexer_tableaux"><code class="name flex">
<span>def <span class="ident">indexer_tableaux</span></span>(<span>self, index_path: str, tableaux_dir: str, force_reindex: bool = False)</span>
</code></dt>
<dd>
<div class="desc"><p>Indexe les descriptions de tableaux dans une base de données ChromaDB. Cette méthode permet de gérer
l'indexation de tableaux, de leurs métadonnées, et des descriptions textuelles associées. L'option
de réindexation force la suppression et la recréation de l'index existant.</p>
<p>:param index_path: Le chemin vers le fichier ou dossier contenant le fichier d'index.
:type index_path: str
:param tableaux_dir: Le chemin vers le répertoire contenant les tableaux à traiter.
:type tableaux_dir: str
:param force_reindex: Indique si l'index existant doit être supprimé et recréé. Par défaut <code>False</code>.
:type force_reindex: bool
:return: Aucun retour.
:rtype: None</p></div>
</dd>
<dt id="backend_python.src.rag.indexer.RAGTableIndex.rechercher_tableaux"><code class="name flex">
<span>def <span class="ident">rechercher_tableaux</span></span>(<span>self, query: str, user_role: str, n_results: int = 10) ‑> Dict[str, Any]</span>
</code></dt>
<dd>
<div class="desc"><p>Permet d'effectuer une recherche en utilisant un modèle d'embedding pour retrouver des tableaux
correspondant à une requête donnée dans une base de données spécifique (ChromaDB). La méthode
retourne une structure contenant les informations des tableaux trouvés ainsi que des
métadonnées associées à ces tableaux.</p>
<p>:param query: La requête de recherche sous forme de chaîne de caractères.
:type query: str
:param user_role: Le rôle utilisateur, utilisé pour déterminer les niveaux d'accès.
:type user_role: str
:param n_results: Le nombre maximum de résultats à retourner. Par défaut, égale à 10.
:type n_results: int
:return: Un dictionnaire contenant :
- query: La requête de recherche utilisée.
- nb_resultats: Le nombre total de résultats retournés.
- tableaux: Une liste de dictionnaires décrivant les tableaux trouvés, y compris leurs
attributs tels que titre, source, feuille, nombre de lignes, colonnes,
chemin d'accès et description.
:rtype: Dict[str, Any]</p></div>
</dd>
<dt id="backend_python.src.rag.indexer.RAGTableIndex.stats_index"><code class="name flex">
<span>def <span class="ident">stats_index</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Affiche les statistiques de l'index, y compris le nombre de tableaux indexés,
les informations sur la base de données et le modèle d'embeddings, ainsi qu'un
échantillon de métadonnées si disponible.</p>
<p>:return: Aucune valeur de retour.</p></div>
</dd>
<dt id="backend_python.src.rag.indexer.RAGTableIndex.traiter_index_complets"><code class="name flex">
<span>def <span class="ident">traiter_index_complets</span></span>(<span>self, index_path: str, tableaux_dir: str) ‑> List[Dict]</span>
</code></dt>
<dd>
<div class="desc"><p>Traite les indexes complets en prenant un chemin d'index et un répertoire
de tableaux, et retourne une liste de dictionnaires contenant les données
traitées.</p>
<p>:param index_path: Chemin du fichier d'index à traiter.
:type index_path: str
:param tableaux_dir: Répertoire contenant les tableaux nécessaires pour
traiter l'index.
:type tableaux_dir: str
:return: Une liste de dictionnaires contenant les données traitées à
partir de l'index complet.
:rtype: List[Dict]</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="backend_python.src.rag" href="index.html">backend_python.src.rag</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="backend_python.src.rag.indexer.demo_rag_pipeline" href="#backend_python.src.rag.indexer.demo_rag_pipeline">demo_rag_pipeline</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="backend_python.src.rag.indexer.RAGTableIndex" href="#backend_python.src.rag.indexer.RAGTableIndex">RAGTableIndex</a></code></h4>
<ul class="">
<li><code><a title="backend_python.src.rag.indexer.RAGTableIndex.afficher_resultats" href="#backend_python.src.rag.indexer.RAGTableIndex.afficher_resultats">afficher_resultats</a></code></li>
<li><code><a title="backend_python.src.rag.indexer.RAGTableIndex.extraire_colonnes_de_description" href="#backend_python.src.rag.indexer.RAGTableIndex.extraire_colonnes_de_description">extraire_colonnes_de_description</a></code></li>
<li><code><a title="backend_python.src.rag.indexer.RAGTableIndex.generer_embeddings" href="#backend_python.src.rag.indexer.RAGTableIndex.generer_embeddings">generer_embeddings</a></code></li>
<li><code><a title="backend_python.src.rag.indexer.RAGTableIndex.get_tableau_data" href="#backend_python.src.rag.indexer.RAGTableIndex.get_tableau_data">get_tableau_data</a></code></li>
<li><code><a title="backend_python.src.rag.indexer.RAGTableIndex.indexer_tableaux" href="#backend_python.src.rag.indexer.RAGTableIndex.indexer_tableaux">indexer_tableaux</a></code></li>
<li><code><a title="backend_python.src.rag.indexer.RAGTableIndex.rechercher_tableaux" href="#backend_python.src.rag.indexer.RAGTableIndex.rechercher_tableaux">rechercher_tableaux</a></code></li>
<li><code><a title="backend_python.src.rag.indexer.RAGTableIndex.stats_index" href="#backend_python.src.rag.indexer.RAGTableIndex.stats_index">stats_index</a></code></li>
<li><code><a title="backend_python.src.rag.indexer.RAGTableIndex.traiter_index_complets" href="#backend_python.src.rag.indexer.RAGTableIndex.traiter_index_complets">traiter_index_complets</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
